import {a}from'./chunk-6SDOGUEN.js';import {z}from'zod';import {SyntaxKind}from'ts-morph';var g={NOT_FOUND:"NOT_FOUND",UNAUTHORIZED:"UNAUTHORIZED",FORBIDDEN:"FORBIDDEN",FETCH_ERROR:"FETCH_ERROR",NOT_CONFIGURED:"NOT_CONFIGURED",INVALID_CONFIG:"INVALID_CONFIG",MISSING_ENV_VARS:"MISSING_ENV_VARS",LOCAL_FILE_ERROR:"LOCAL_FILE_ERROR",PARSE_ERROR:"PARSE_ERROR",VALIDATION_ERROR:"VALIDATION_ERROR",UNKNOWN_ERROR:"UNKNOWN_ERROR"},u=class extends Error{code;statusCode;context;suggestion;timestamp;cause;constructor(i,e={}){super(i),this.name="RegistryError",this.code=e.code||g.UNKNOWN_ERROR,this.statusCode=e.statusCode,this.cause=e.cause,this.context=e.context,this.suggestion=e.suggestion,this.timestamp=new Date,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor);}toJSON(){return {name:this.name,message:this.message,code:this.code,statusCode:this.statusCode,context:this.context,suggestion:this.suggestion,timestamp:this.timestamp,stack:this.stack}}},E=class extends u{constructor(e,t){let n=`The item at ${e} was not found. It may not exist at the registry.`;super(n,{code:g.NOT_FOUND,statusCode:404,cause:t,context:{url:e},suggestion:"Check if the item name is correct and the registry URL is accessible."});this.url=e;this.name="RegistryNotFoundError";}},$=class extends u{constructor(e,t){let n=`You are not authorized to access the item at ${e}. If this is a remote registry, you may need to authenticate.`;super(n,{code:g.UNAUTHORIZED,statusCode:401,cause:t,context:{url:e},suggestion:"Check your authentication credentials and environment variables."});this.url=e;this.name="RegistryUnauthorizedError";}},_=class extends u{constructor(e,t){let n=`You are not authorized to access the item at ${e}. If this is a remote registry, you may need to authenticate.`;super(n,{code:g.FORBIDDEN,statusCode:403,cause:t,context:{url:e},suggestion:"Check your authentication credentials and environment variables."});this.url=e;this.name="RegistryForbiddenError";}},C=class extends u{constructor(e,t,n,a){let o=t?`Failed to fetch from registry (${t}): ${e}`:`Failed to fetch from registry: ${e}`,p=typeof a=="string"&&a?`${o} - ${a}`:o,r="Check your network connection and try again.";t===404?r="The requested resource was not found. Check the URL or item name.":t===500?r="The registry server encountered an error. Try again later.":t&&t>=400&&t<500&&(r="There was a client error. Check your request parameters.");super(p,{code:g.FETCH_ERROR,statusCode:t,cause:a,context:{url:e,responseBody:n},suggestion:r});this.url=e;this.responseBody=n;this.name="RegistryFetchError";}},k=class extends u{constructor(e){let t=e?`Unknown registry "${e}". Make sure it is defined in components.json as follows:
{
  "registries": {
    "${e}": "[URL_TO_REGISTRY]"
  }
}`:'Unknown registry. Make sure it is defined in components.json under "registries".';super(t,{code:g.NOT_CONFIGURED,context:{registryName:e},suggestion:"Add the registry configuration to your components.json file. Consult the registry documentation for the correct format."});this.registryName=e;this.name="RegistryNotConfiguredError";}},w=class extends u{constructor(e,t){super(`Failed to read local registry file: ${e}`,{code:g.LOCAL_FILE_ERROR,cause:t,context:{filePath:e},suggestion:"Check if the file exists and you have read permissions."});this.filePath=e;this.name="RegistryLocalFileError";}},j=class extends u{constructor(e,t){let n=`Failed to parse registry item: ${e}`;t instanceof z.ZodError&&(n=`Failed to parse registry item: ${e}
${t.errors.map(a=>`  - ${a.path.join(".")}: ${a.message}`).join(`
`)}`);super(n,{code:g.PARSE_ERROR,cause:t,context:{item:e},suggestion:"The registry item may be corrupted or have an invalid format. Please make sure it returns a valid JSON object. See https://ui.shadcn.com/schema/registry-item.json."});this.item=e;this.parseError=t,this.name="RegistryParseError";}parseError},S=class extends u{constructor(e,t){let n=`Registry "${e}" requires the following environment variables:

`+t.map(a=>`  \u2022 ${a}`).join(`
`);super(n,{code:g.MISSING_ENV_VARS,context:{registryName:e,missingVars:t},suggestion:"Set the required environment variables to your .env or .env.local file."});this.registryName=e;this.missingVars=t;this.name="RegistryMissingEnvironmentVariablesError";}},v=class extends u{constructor(e){let t=`Invalid registry namespace: "${e}". Registry names must start with @ (e.g., @shadcn, @v0).`;super(t,{code:g.VALIDATION_ERROR,context:{name:e},suggestion:"Use a valid registry name starting with @ or provide a direct URL to the registry."});this.name=e;this.name="RegistryInvalidNamespaceError";}};var D=class extends u{constructor(e,t){let n=`Invalid components.json configuration in ${e}.`;t instanceof z.ZodError&&(n=`Invalid components.json configuration in ${e}:
${t.errors.map(a=>`  - ${a.path.join(".")}: ${a.message}`).join(`
`)}`);super(n,{code:g.INVALID_CONFIG,cause:t,context:{cwd:e},suggestion:"Check your components.json file for syntax errors or invalid configuration. Run 'npx shadcn@latest init' to regenerate a valid configuration."});this.cwd=e;this.name="ConfigParseError";}},L=class extends u{parseError;constructor(i){let e="Failed to parse registries index";if(i instanceof z.ZodError){let t=i.errors.filter(n=>n.path.length>0).map(n=>`"${n.path[0]}"`).filter((n,a,o)=>o.indexOf(n)===a);t.length>0?e=`Failed to parse registries index. Invalid registry namespace(s): ${t.join(", ")}
${i.errors.map(n=>`  - ${n.path.join(".")}: ${n.message}`).join(`
`)}`:e=`Failed to parse registries index:
${i.errors.map(n=>`  - ${n.path.join(".")}: ${n.message}`).join(`
`)}`;}super(e,{code:g.PARSE_ERROR,cause:i,context:{parseError:i},suggestion:"The registries index may be corrupted or have invalid registry namespace format. Registry names must start with @ (e.g., @shadcn, @example)."}),this.parseError=i,this.name="RegistriesIndexParseError";}},N=class extends u{constructor(e,t){let n=`Invalid icon library "${e}". Valid options are: ${t.join(", ")}`;super(n,{code:g.INVALID_CONFIG,context:{iconLibrary:e,validOptions:t},suggestion:`Update the "iconLibrary" field in your components.json to one of: ${t.join(", ")}`});this.iconLibrary=e;this.validOptions=t;this.name="InvalidConfigIconLibraryError";}};var H=async({sourceFile:s,config:i})=>{let e=i.iconLibrary;if(!e)return s;if(!(e in a))throw new N(e,Object.keys(a));let t=e,n=a[t],a$1=[];for(let o of s.getDescendantsOfKind(SyntaxKind.JsxSelfClosingElement)){if(o.getTagNameNode()?.getText()!=="IconPlaceholder")continue;let p=o.getAttributes().find(c=>c.getKind()!==SyntaxKind.JsxAttribute?false:c.asKindOrThrow(SyntaxKind.JsxAttribute).getNameNode().getText()===t);if(!p)continue;let r=p.asKindOrThrow(SyntaxKind.JsxAttribute),m=r.getInitializer()?.getText().replace(/^["']|["']$/g,"");if(!m)continue;a$1.includes(m)||a$1.push(m);let R=n.usage.match(/<(\w+)([^>]*)\s*\/>/);r.remove();for(let c of o.getAttributes()){if(c.getKind()!==SyntaxKind.JsxAttribute)continue;let f=c.asKindOrThrow(SyntaxKind.JsxAttribute);f.getNameNode().getText()in a&&f.remove();}if(!R){o.getTagNameNode()?.replaceWithText(m);continue}let[,y,I]=R;if(y==="ICON"){let c=o.getAttributes().filter(f=>f.getKind()!==SyntaxKind.JsxAttribute?true:!(f.asKindOrThrow(SyntaxKind.JsxAttribute).getNameNode().getText()in a)).map(f=>f.getText()).join(" ");c.trim()?o.replaceWithText(`<${m} ${c} />`):o.getTagNameNode()?.replaceWithText(m);}else {let c=new Set(o.getAttributes().filter(l=>l.getKind()===SyntaxKind.JsxAttribute).map(l=>l.asKindOrThrow(SyntaxKind.JsxAttribute).getNameNode().getText())),O=I.replace(/\{ICON\}/g,`{${m}}`).trim().split(/\s+(?=\w+=)/).filter(l=>l).map(l=>{let b=l.split("=")[0];return b&&!c.has(b)?l:null}).filter(Boolean),A=o.getAttributes().filter(l=>l.getKind()!==SyntaxKind.JsxAttribute?true:!(l.asKindOrThrow(SyntaxKind.JsxAttribute).getNameNode().getText()in a)).map(l=>l.getText()).join(" "),F=[...O,A].filter(Boolean).join(" ");o.replaceWithText(`<${y} ${F} />`);}}for(let o of s.getImportDeclarations()??[])if(o.getModuleSpecifier()?.getText()?.includes("icon-placeholder")){let m=(o.getNamedImports()??[]).find(x=>x.getName()==="IconPlaceholder");m&&m.remove(),o.getNamedImports()?.length===0&&o.remove();}if(a$1.length>0){let o=n.import.split(`
`),p=[];for(let r of o){let m=r.match(/import\s+{([^}]+)}\s+from\s+['"]([^'"]+)['"]/);if(!m)continue;let[,x,R]=m,y=x.split(",").map(c=>c.trim()).map(c=>c==="ICON"?a$1.map(f=>({name:f})):{name:c}).flat(),I=s.addImportDeclaration({moduleSpecifier:R,namedImports:y});p.push(I);}if(!U(s))for(let r of p)r.replaceWithText(r.getText().replace(";",""));}return s};function U(s){return s.getImportDeclarations()?.[0]?.getText().endsWith(";")??false}var q=async({sourceFile:s,config:i})=>{let t=i.menuColor==="inverted"?"dark":"";for(let n of s.getDescendantsOfKind(SyntaxKind.JsxAttribute)){if(n.getNameNode().getText()!=="className")continue;let o=n.getInitializer();if(!o)continue;let p=o.getText();if(!p.includes("cn-menu-target"))continue;let r=p.replace(/cn-menu-target/g,t);t||(r=r.replace(/\s{2,}/g," "),r=r.replace(/"\s+/g,'"'),r=r.replace(/\s+"/g,'"'),r=r.replace(/,\s*""\s*,/g,","),r=r.replace(/\(\s*""\s*,/g,"("),r=r.replace(/,\s*""\s*\)/g,")")),n.setInitializer(r);}return s};export{u as a,E as b,$ as c,_ as d,C as e,k as f,w as g,j as h,S as i,v as j,D as k,L as l,H as m,q as n};//# sourceMappingURL=chunk-YPHLD64H.js.map
//# sourceMappingURL=chunk-YPHLD64H.js.map